<div class="container">
  <h1><%= @organization.name %></h1>
  <% @members = @organization.members %>
  <%= render 'shared/navbar', :collection => @members %>
  <div id="category_tabs">

    <div class="col-md-6 col-xs-12" id="mixContainer">

      <div class="control-bar no-pad col-md-12">
        <div class="col-md-4" style="padding:0px 5px;"><div class="filter col-md-12" data-filter="all">Show All</div></div>
        <div class="col-md-4" style="padding:0px 5px;"><div class="filter col-md-12" data-filter=".incomplete">Incomplete</div></div>
        <div class="col-md-4" style="padding:0px 5px;"><div class="filter col-md-12" data-filter=".complete">Complete</div></div>
      </div>

      <ul>
        <% @brain_dump_categories.each do |category| %>
          <li class="mix incomplete col-md-4 col-xs-6 no-pad"><a href="#<%= category.name.gsub(' ','_') %>" class="col-md-12 no-pad"><%= category.name %></a><div id="jqmeter-container_<%= category.id %>"></div></li>
          <script type="text/javascript">
            progressBar('<%= category.id %>', '<%= category.brain_dumps.count %>', '<%= category.brain_dumps.where(done:true).count %>');
          </script>
        <% end %>
      </ul>

    </div>



    <% @brain_dump_categories.each do |category| %>
      <div class="col-md-6 col-xs-12" id="<%= category.name.gsub(' ','_') %>">
        <h5><%= category.name.titleize %></h5>

        <% if category.brain_dumps.present? %>

          <form class="ac-custom ac-checkbox ac-checkmark" autocomplete="off">

            <ul class="brain-dump-category-list col-md-12 no-pad" data-category-id="<%= category.id %>">
              <% category.brain_dumps.each do |word| %>

                <li class="ac-custom-list-item col-md-12 no-pad" data-id="<%= word.id %>" data-done="<%= word.done? %>"><input id="<%= word.id %>" name="<%= word.id %>" type="checkbox"><label for="<%= word.id %>"><%= word.word.humanize %></label>

                  <a class="expander" href="#">Expand</a>

                  <div class="content col-md-12 no-pad" data-brain-dump-id="<%= word.id %>">

                    <div class="actions-bar">
                      <p><b>Add a new:</b></p>
                      <a href="#" class="blue-btn blue-btn-hover show-note-form">Note</a>
                      <a href="#" class="blue-btn blue-btn-hover show-file-form">File</a>
                      <!-- <a href="#" class="blue-btn blue-btn-hover show-link-form">Link</a> -->
                    </div>

                    <div id="NoteForm" class="hidden"><%= render 'brain_dump_notes/note_form', word: word %></div>
                    <div id="FileForm" class="hidden"><%= render 'brain_dump_notes/file_form', word: word %></div>

                    <ul id="brainDumpNotesList" class="col-md-12 no-pad">
                      <% if word.brain_dump_notes.present? %>

                        <% word.brain_dump_notes.order('created_at DESC').each do |note| %>
                          <%= render 'brain_dump_notes/note', note: note %>
                        <% end %>

                      <% end %>
                    </ul>

                  </div>

                </li>

              <% end %>

            </ul>

          </form>

        <% end %>

      </div>
    <% end %>

  </div>

</div>


<script>
  $(document).ready(function() {

    $(function() {
      $( "#category_tabs" ).tabs();
    });

    $(function() {
      $('#mixContainer').mixItUp();
    });

    $(function() {
      $('.expander').simpleexpand();
    });

    createCheckboxes();


    $(function() {
      $.each($("li[data-done='true']"), function() {
        $(this).find('label').addClass('special');
      });
    });

    $(".show-note-form").off('click').on('click', function(e) {
      e.preventDefault();
      var $this = $(this),
          NoteForm = $this.parents(".content").find("#NoteForm");
          FileForm = $this.parents(".content").find("#FileForm");

      $(NoteForm).fadeToggle(400).toggleClass('hidden');
      $(FileForm).addClass('hidden');
    });

    $(".show-file-form").off('click').on('click', function(e) {
      e.preventDefault();
      var $this = $(this),
          NoteForm = $this.parents(".content").find("#NoteForm");
          FileForm = $this.parents(".content").find("#FileForm");

      $(FileForm).fadeToggle(400).toggleClass('hidden');
      $(NoteForm).addClass('hidden');
    });


  });
</script>

<style>
  .outer-therm {
    margin: 0px;
    margin-top: 50px;
  }

  .therm {
    border-radius: 0px;
  }

  .inner-therm {
    font-size: 12px;
  }

  .inner-therm span {
    padding: 0px !important;
    float: left;
    font-family: 'Open Sans', sans-serif;
    font-size: 12px;
    position: absolute;
    left: 3px;
    font-weight: 600;
    bottom: 8px;
  }
</style>


